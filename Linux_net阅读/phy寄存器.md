phy这个东西本身是在IEEE802.3中得到定义了的，所以没啥多说的

# MDIO

MDIO使用简单的双线串行接口，用于链接PHY并控制PHY，称为MII Management Interface

管理接口通过一对MII或者GMII传输的信号，帧格式和协议规范，以及通过这些帧读取和写入的寄存器集合组成。

MII使用两个基本寄存器，GMII使用了第三个。

MII基本寄存器  由两个寄存器组成，分别是控制寄存器（寄存器0）和状态寄存器（寄存器1）

GMII在这俩之外还包括了寄存器15（扩展状态寄存器）

这个status和ctrl功能被认为是100Mbps和1000Mbps的基本功能。（也就是说，这三个寄存器才是最基本的）

寄存器2-14是扩展寄存器集合的一部分

寄存器4-10的格式是为了使用特定的自协商协议定义的。这些寄存器格式由寄存器1和15定义

# 寄存器

具体而言，前16个寄存器0-15是有规定好功能定义的

后面16-31是厂家自己设计的。

（但是为什么在phy.h中对后面的寄存器也有呢？？？）

关于这16个寄存器，功能分别如下记录

使用X.Y方式记录，比如0.15就表示第0号寄存器的第15个bit。

这些寄存器都是16位的。

# 0号寄存器-Ctrl（MII和GMII下都是基本寄存器）

| Bit(s）    | Name                     | Description                                                                                                                          | 读写情况    |
| --------- | ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------ | ------- |
| 0.15      | Reset                    | 默认是0，位置位1表示reset，该位置为0表示正常工作，每次phy复位应当在0.5s内完成，复位过程中保持bit15为1，复位之后自动清零。需要注意的是，一般要改变端口工作模式，比如速率或者协商信息的，需要设置完相应寄存器之后，再reset phy来让配置生效。 | 可读写，自清理 |
| 0.14      | Loopback                 | 逻辑上会把发出去的再送回来，但有些会导致直接linkdown，默认情况下是0。                                                                                              | 可读写     |
| 0.13和0.16 | Speed Selection          | 0.6/0.13: 1/1保留，1/0表示1000Mbps，0/1表示100Mbps，0/0表示10Mbps                                                                               | 可读写     |
| 0.12      | auto-negotion-enable     | 置位表示允许自动协商，否则不允许                                                                                                                     | 可读写     |
| 0.11      | Power Down               | 置位表示下电，为0则表示正常工作                                                                                                                     | 可读写     |
| 0.10      | Isolate                  | 将PHY和MII或者GMII隔离开来                                                                                                                   | 可读写     |
| 0.9       | Restart auto-negotiation | 1表示重启自动协商                                                                                                                            | 可读写且自清理 |
| 0.8       | duplex mode              | 1表示全双工模式，0表示半双工模式                                                                                                                    | 可读写     |
| 0.7       | collision test           | 1表示启用COL信号，0表示禁止                                                                                                                     | 可读写     |
| 0.5       | unidirectional enable    | 当0.12置位且0.8为0，也就是半双工模式下自协商，这一位没啥用，当0.12为0且0.18为1，全双工模式下，无自协商，0.5置位表示启用从独立于媒体的接口传输，无论PHY是否已经确定建立有效连接，不置位表示只有PHY确定有有效连接的时候，才置位。        | 可读写     |
| 剩下的保留     |                          |                                                                                                                                      | 可读写     |



# 1号寄存器-Status（MII和GMII下都是基本寄存器）

| Bit(s) | Name                      | Description                                        | 读写情况 |
| ------ | ------------------------- | -------------------------------------------------- | ---- |
| 1.15   | 100-BASE-T4               | 从上到下这些都是1表示支持该模式，0表示不支持该模式                         | 只读   |
| 1.14   | 100-BASE-X全双工             |                                                    | 只读   |
| 1.13   | 100-BASE-X半双工             |                                                    | 只读   |
| 1.12   | 10Mbps全双工                 |                                                    | 只读   |
| 1.11   | 10Mbps半双工                 |                                                    | 只读   |
| 1.10   | 100BASE-T2全双工             |                                                    | 只读   |
| 1.9    | 100BASE-T2半双工             |                                                    | 只读   |
| 1.8    | 扩展状态位                     | 置位表示15号寄存器启用                                       | 只读   |
| 1.7    | Unidirectional ability    | 和0.5的内容差不多，只不过0.5表示的是置位的方式，这个是status，所以不需要0.12和0.8 | 只读   |
| 1.6    | MF preamble suppression   | 置位表示接受管理帧，无论是否带前导码                                 | 只读   |
| 1.5    | Auto-negotiation complete | 1表示完成自动协商工作了                                       | 只读   |
| 1.4    | Remote-Fault              | 1表示检测到远程错误                                         | 只读   |
| 1.3    | Auto-negotiation ability  | 置位表示PHY可以接受自动协商                                    | 只读   |
| 1.2    | Link Status               | 置位表示Link up                                        | 只读   |
| 1.1    | Jabber Detect             | （没看明白）                                             | 只读   |
| 1.0    | 扩展的能力                     | 置位表示15号寄存器可以启用                                     | 只读   |

这里对寄存器说明有Latching low和Latching high（不太懂翻译成中文是啥，但是说了全都是只读的）

# 2号寄存器-PHY_id

# 3号寄存器-PHY_id

2和3都是用来做这个的。2为高16位，3为低16位。

# 4号寄存器-Auto-Negotiation-Advertisement

# 5号寄存器-Auto-Negotiation-Link-Partner-Base-Page-Ability

# 6号寄存器-Auto-Negotiation-Expansion

# 7号寄存器-Auto-Negotiation-Next-Page-Transmit

# 8号寄存器-Auto-Negotiation-Link-Partner-Received-Next-Page

# 9号寄存器-Master-Slave-Control-Register

# 10号寄存器-Master-Slave-Status-Register

上面的自动协商的寄存器看28.2.4.1和37.2.5.1

主从模式的9和10看32.5和40.5



# 11号寄存器-PSE-Ctrl-Register

看33.5.1.1

# 12号寄存器-PSE-Status-Register

33.5.1.2

# 13号寄存器-MMD-Access-Ctrl-Register

| Bit(s)   | Name     | Description                            | 读写位 |
| -------- | -------- | -------------------------------------- | --- |
| 13.15:14 | Function | 00=address，01=数据，没有post自增，10=数据，当读写的时候 | 可读写 |
| 13.13:5  | 保留       |                                        | 可读写 |
| 13.4:0   | DEVAD    | 设备地址                                   | 可读写 |

# 14号寄存器-MMD-Access-Address-Data-Register

全都用来表示地址数据

# 15号寄存器-Extended-Status（GMII下是基本寄存器）

| bit(s)  | Name          | description | 读写  |
| ------- | ------------- | ----------- | --- |
| 15.15   | 1000BASE-X全双工 | 和1号寄存器差不多   | 只读  |
| 15.14   | 1000BASE-X半双工 |             | 只读  |
| 15.13   | 1000BASE-T全双工 |             | 只读  |
| 15.12   | 1000BASE-T半双工 |             | 只读  |
| 15.11：0 | 全都保留          |             | 只读  |

# 剩余寄存器-厂商自定义



（好多呀。。。）



# 
